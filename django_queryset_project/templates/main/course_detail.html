{% extends "base.html" %}
{% block title %} | {{ course.title }}{% endblock %}
{% block content %}
<a href="{% url 'course_list' %}" class="btn btn-sm btn-outline-secondary mb-3">← Back</a>

<div class="row g-4">
  <div class="col-md-8">
    <div class="card p-3">
      <h4>{{ course.title }}</h4>
      <p class="text-muted">{{ course.description|default:"No description." }}</p>
      <small class="qs-label">course.students.all().order_by('name')</small>

      <table class="table table-sm mt-3">
        <thead class="table-dark"><tr><th>#</th><th>Name</th><th>Age</th><th>Email</th></tr></thead>
        <tbody>
          {% for s in students %}
          <tr>
            <td>{{ s.id }}</td>
            <td>{{ s.name }}</td>
            <td>{{ s.age }}</td>
            <td>{{ s.email|default:"—" }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="4" class="text-muted">No students in this course.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card p-3">
      <h6>Aggregate Stats <span class="qs-label">aggregate()</span></h6>
      <table class="table table-sm mb-0">
        <tr><td>Total students</td><td><strong>{{ stats.total }}</strong></td></tr>
        <tr><td>Average age</td><td><strong>{{ stats.avg_age|floatformat:1|default:"—" }}</strong></td></tr>
        <tr><td>Oldest age</td><td><strong>{{ stats.max_age|default:"—" }}</strong></td></tr>
        <tr><td>Youngest age</td><td><strong>{{ stats.min_age|default:"—" }}</strong></td></tr>
      </table>
    </div>
  </div>
</div>
{% endblock %}
